{
 "add_total_row": 1,
 "columns": [],
 "creation": "2024-11-20 13:55:15.178686",
 "disabled": 0,
 "docstatus": 0,
 "doctype": "Report",
 "filters": [
  {
   "fieldname": "end_date",
   "fieldtype": "Date",
   "label": "Ng\u00e0y k\u1ebft th\u00fac",
   "mandatory": 1,
   "wildcard_filter": 0
  },
  {
   "fieldname": "company",
   "fieldtype": "Link",
   "label": "C\u00f4ng ty",
   "mandatory": 1,
   "options": "Company",
   "wildcard_filter": 0
  }
 ],
 "idx": 0,
 "is_standard": "Yes",
 "letterhead": null,
 "modified": "2024-11-20 13:56:36.302440",
 "modified_by": "Administrator",
 "module": "DBIZ APP",
 "name": "GL08 - S\u1ed5 qu\u1ef9 chi ti\u1ebft ti\u1ec1n m\u1eb7t",
 "owner": "Administrator",
 "prepared_report": 0,
 "query": "WITH NAME_TMP AS (\n\tSELECT 'I. L\u01b0u chuy\u1ec3n ti\u1ec1n t\u1ec7 t\u1eeb ho\u1ea1t \u0111\u1ed9ng kinh doanh' RPT_NAME, NULL RPT_KEY \n\tUNION ALL\n\tSELECT'1. Ti\u1ec1n t\u1eeb b\u00e1n h\u00e0ng, cung c\u1ea5p d\u1ecbch v\u1ee5 v\u00e0 doanh thu kh\u00e1c' RPT_NAME, '01' RPT_KEY \n\tUNION ALL\n\tSELECT '2. Ti\u1ec1n chi tr\u1ea3 cho ng\u01b0\u1eddi cung c\u1ea5p h\u00e0ng h\u00f3a v\u00e0 d\u1ecbch v\u1ee5' RPT_NAME, '02' RPT_KEY \n\tUNION ALL\n\tSELECT '3. Ti\u1ec1n chi tr\u1ea3 cho ng\u01b0\u1eddi lao \u0111\u1ed9ng' RPT_NAME, '03' RPT_KEY \n\tUNION ALL\n\tSELECT '4. Ti\u1ec1n l\u00e3i vay \u0111\u00e3 tr\u1ea3' RPT_NAME, '04' RPT_KEY \n\tUNION ALL\n\tSELECT '5. Thu\u1ebf thu nh\u1eadp doanh nghi\u1ec7p \u0111\u00e3 n\u1ed9p' RPT_NAME, '05' RPT_KEY \n\tUNION ALL\n\tSELECT '6. Ti\u1ec1n thu kh\u00e1c t\u1eeb H\u0110KD' RPT_NAME, '06' RPT_KEY \n\tUNION ALL\n\tSELECT '7. Ti\u1ec1n chi kh\u00e1c cho H\u0110KD' RPT_NAME, '07' RPT_KEY \n\tUNION ALL\n\tSELECT 'LCTT Thu\u1ea7n t\u1eeb H\u0110KD' RPT_NAME, '20' RPT_KEY \n\tUNION ALL\n\tSELECT 'II. L\u01b0u chuy\u1ec3n ti\u1ec1n t\u1ec7 t\u1eeb ho\u1ea1t \u0111\u1ed9ng \u0111\u1ea7u t\u01b0' RPT_NAME, NULL RPT_KEY \n\tUNION ALL\n\tSELECT '1. Ti\u1ec1n chi mua s\u1eafm, x\u00e2y d\u1ef1ng TSC\u0110 v\u00e0 t\u00e0i s\u1ea3n kh\u00e1c' RPT_NAME, '21' RPT_KEY \n\tUNION ALL\n\tSELECT '2. Ti\u1ec1n thu t\u1eeb thanh l\u00fd, nh\u01b0\u1ee3ng b\u00e1n TSC\u0110 v\u00e0 t\u00e0i s\u1ea3n kh\u00e1c' RPT_NAME, '22' RPT_KEY \n\tUNION ALL\n\tSELECT '3. Ti\u1ec1n chi cho vay, mua c\u00f4ng c\u1ee5 n\u1ee3 c\u1ee7a \u0111\u01a1n v\u1ecb kh\u00e1c' RPT_NAME, '23' RPT_KEY \n\tUNION ALL\n\tSELECT '4. Ti\u1ec1n thu h\u1ed3i cho vay, b\u00e1n l\u1ea1i c\u00e1c c\u00f4ng c\u1ee5 n\u1ee3 c\u1ee7a \u0111\u01a1n v\u1ecb kh\u00e1c' RPT_NAME, '24' RPT_KEY \n\tUNION ALL\n\tSELECT '5. Ti\u1ec1n chi \u0111\u1ea7u t\u01b0 g\u00f3p v\u1ed1n v\u00e0o \u0111\u01a1n v\u1ecb kh\u00e1c' RPT_NAME, '25' RPT_KEY \n\tUNION ALL\n\tSELECT '6. Ti\u1ec1n thu h\u1ed3i \u0111\u1ea7u t\u01b0 g\u00f3p v\u1ed1n v\u00e0o \u0111\u01a1n v\u1ecb kh\u00e1c' RPT_NAME, '26' RPT_KEY \n\tUNION ALL\n\tSELECT '7. Ti\u1ec1n thu l\u00e3i cho vay, c\u1ed5 t\u1ee9c v\u00e0 l\u1ee3i nhu\u1eadn \u0111\u01b0\u1ee3c chia' RPT_NAME, '27' RPT_KEY \n\tUNION ALL\n\tSELECT 'LCTT thu\u1ea7n t\u1eeb Ho\u1ea1t \u0111\u1ed9ng \u0111\u1ea7u t\u01b0' RPT_NAME, '30' RPT_KEY \n\tUNION ALL\n\tSELECT 'III. L\u01b0u chuy\u1ec3n ti\u1ec1n t\u1ec7 t\u1eeb ho\u1ea1t \u0111\u1ed9ng t\u00e0i ch\u00ednh' RPT_NAME, NULL RPT_KEY \n\tUNION ALL\n\tSELECT '1.Ti\u1ec1n thu t\u1eeb ph\u00e1t h\u00e0nh c\u1ed5 phi\u1ebfu, nh\u1eadn v\u1ed1n g\u00f3p c\u1ee7a ch\u1ee7 s\u1edf h\u1eefu' RPT_NAME, '31' RPT_KEY \n\tUNION ALL\n\tSELECT '2.Ti\u1ec1n chi tr\u1ea3 v\u1ed1n g\u00f3p cho c\u00e1c ch\u1ee7 s\u1edf h\u1eefu, mua l\u1ea1i c\u1ed5 phi\u1ebfu c\u1ee7a doanh nghi\u1ec7p \u0111\u00e3 ph\u00e1t h\u00e0nh' RPT_NAME, '32' RPT_KEY \n\tUNION ALL\n\tSELECT '3. Ti\u1ec1n vay ng\u1eafn h\u1ea1n, d\u00e0i h\u1ea1n nh\u1eadn \u0111\u01b0\u1ee3c' RPT_NAME, '33' RPT_KEY \n\tUNION ALL\n\tSELECT '4. Ti\u1ec1n chi tr\u1ea3 n\u1ee3 g\u1ed1c vay' RPT_NAME, '34' RPT_KEY \n\tUNION ALL\n\tSELECT '5. C\u1ed5 t\u1ee9c, l\u1ee3i nhu\u1eadn \u0111\u00e3 tr\u1ea3 cho ch\u1ee7 s\u1edf h\u1eefu' RPT_NAME, '35' RPT_KEY \n\tUNION ALL\n\tSELECT '6. Ti\u1ec1n chi tr\u1ea3 n\u1ee3 thu\u00ea t\u00e0i ch\u00ednh' RPT_NAME, '36' RPT_KEY \n\tUNION ALL\n\tSELECT 'LCTT thu\u1ea7n t\u1eeb Ho\u1ea1t \u0111\u1ed9ng t\u00e0i ch\u00ednh' RPT_NAME, '40' RPT_KEY \n\tUNION ALL\n\tSELECT 'L\u01b0u chuy\u1ec3n ti\u1ec1n t\u1ec7 thu\u1ea7n trong k\u1ef3 (50 = 20 + 30 + 40)' RPT_NAME, '50' RPT_KEY \n\tUNION ALL\n\tSELECT 'Ti\u1ec1n v\u00e0 t\u01b0\u01a1ng \u0111\u01b0\u01a1ng ti\u1ec1n \u0111\u1ea7u k\u1ef3' RPT_NAME, '60' RPT_KEY \n\tUNION ALL\n\tSELECT '\u1ea2nh h\u01b0\u1edfng c\u1ee7a thay \u0111\u1ed5i t\u1ef7 gi\u00e1 h\u1ed1i \u0111o\u00e1i quy \u0111\u1ed5i ngo\u1ea1i t\u1ec7' RPT_NAME, '61' RPT_KEY \n\tUNION ALL\n\tSELECT 'Ti\u1ec1n v\u00e0 t\u01b0\u01a1ng \u0111\u01b0\u01a1ng ti\u1ec1n cu\u1ed1i k\u1ef3 (70 = 50 + 60 + 61)' RPT_NAME, '70' RPT_KEY \n\t)\n, TIMET AS (\n\tSELECT \n\tDATE(%(end_date)s) END,\n\tDATE(CONCAT(YEAR(DATE(%(end_date)s)), '-01-01')) START,\n\tDATE(CONCAT(YEAR(DATE(%(end_date)s)) - 1, '-12-31')) PEND,\n\tDATE(CONCAT(YEAR(DATE(%(end_date)s)) - 1, '-01-01')) PSTART\n)\n, GLT AS (\n\tSELECT \n\t\tGL.CREDIT CO, \n\t\tGL.DEBIT NO,\n\t\tGL.POSTING_DATE DT,\n\t\tGL.ACCOUNT ACC,\n\t\tGL.AGAINST AGA\n\tFROM `tabGL Entry` GL\n\tWHERE GL.COMPANY =%(company)s\n\tAND IS_CANCELLED = 0\n)\n, TMP0 AS(  \n\tSELECT '01' RPT_KEY, \n\tC.AMT AMT,\n\tP.AMT P_AMT\n\tFROM (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL \n\t\tCROSS JOIN TIMET T \n\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111','121','113')\n\t\tAND SUBSTR(GL.AGA,1,3) IN ('511','131','515','121')\n\t\tAND GL.DT BETWEEN T.START AND T.END\n\t\t) C \n\tLEFT JOIN (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111','121','113')\n\t\tAND SUBSTR(GL.AGA,1,3) IN ('511','131','515','121')\n\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\n\t\t) P ON 1=1\n\n\tUNION ALL\n\n\tSELECT '02' RPT_KEY, \n\tC.AMT AMT,\n\tP.AMT P_AMT\n\tFROM (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('331','152','153','154','156') \n\t\tAND SUBSTR(GL.AGA,1,3) IN ('111','121','113')\n\t\tAND GL.DT BETWEEN T.START AND T.END\n\t\t) C \n\tLEFT JOIN (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('331','152','153','154','156')\n\t\tAND SUBSTR(GL.AGA,1,3) IN ('111','121','113')\n\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\n\t\t) P ON 1=1\n\n\tUNION ALL\n\n\tSELECT '03' RPT_KEY, \n\tC.AMT AMT,\n\tP.AMT P_AMT\n\tFROM (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('334') \n\t\tAND SUBSTR(GL.AGA,1,3) IN ('111','121')\n\t\tAND GL.DT BETWEEN T.START AND T.END\n\t\t) C \n\tLEFT JOIN (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('334') \n\t\tAND SUBSTR(GL.AGA,1,3) IN ('111','121')\n\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\n\t\t) P ON 1=1\n\n\tUNION ALL\n\n\tSELECT '04' RPT_KEY, \n\tC.AMT AMT,\n\tP.AMT P_AMT\n\tFROM (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE (SUBSTR(GL.ACC,1,3) IN ('335', '242') OR SUBSTR(GL.ACC,1,4) IN ('6354'))\n\t\tAND SUBSTR(GL.AGA,1,3) IN ('111','121')\n\t\tAND GL.DT BETWEEN T.START AND T.END\n\t\t) C \n\tLEFT JOIN (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE (SUBSTR(GL.ACC,1,3) IN ('335', '242') OR SUBSTR(GL.ACC,1,4) IN ('6354'))\n\t\tAND SUBSTR(GL.AGA,1,3) IN ('111','121')\n\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\n\t\t) P ON 1=1\n\n\tUNION ALL\n\n\tSELECT '05' RPT_KEY, \n\tC.AMT AMT,\n\tP.AMT P_AMT\n\tFROM (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,4) IN ('3334')\n\t\tAND SUBSTR(GL.AGA,1,3) IN ('111','121')\n\t\tAND GL.DT BETWEEN T.START AND T.END\n\t\t) C \n\tLEFT JOIN (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,4) IN ('3334')\n\t\tAND SUBSTR(GL.AGA,1,3) IN ('111','121')\n\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\n\t\t) P ON 1=1\n\n\tUNION ALL\n\n\tSELECT '06' RPT_KEY, \n\tC.AMT AMT,\n\tP.AMT P_AMT\n\tFROM (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111','121','113') \n\t\tAND SUBSTR(GL.AGA,1,3) IN ('711', '133', '141', '244')\n\t\tAND GL.DT BETWEEN T.START AND T.END\n\t\t) C \n\tLEFT JOIN (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111','121','113') \n\t\tAND SUBSTR(GL.AGA,1,3) IN ('711', '133', '141', '244')\n\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\n\t\t) P ON 1=1\n\n\tUNION ALL\n\n\tSELECT '07' RPT_KEY, \n\tC.AMT AMT,\n\tP.AMT P_AMT\n\tFROM (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('811', '161', '244', '333', '338',  '344', '352', '353', '356')\n\t\tAND SUBSTR(GL.AGA,1,3) IN ('111','121','113')\n\t\tAND GL.DT BETWEEN T.START AND T.END\n\t\t) C \n\tLEFT JOIN (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('811', '161', '244', '333', '338',  '344', '352', '353', '356')\n\t\tAND SUBSTR(GL.AGA,1,3) IN ('111','121','113')\n\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\n\t\t) P ON 1=1\n\n\tUNION ALL\n\n\tSELECT '21' RPT_KEY, \n\tC.AMT AMT,\n\tP.AMT P_AMT\n\tFROM (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE (SUBSTR(GL.ACC,1,3) IN ('211', '213', '217', '241', '331') OR SUBSTR(GL.ACC,1,4) IN ('3411'))\n\t\tAND SUBSTR(GL.AGA,1,3) IN ('111', '112', '113')\n\t\tAND GL.DT BETWEEN T.START AND T.END\n\t\t) C \n\tLEFT JOIN (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE (SUBSTR(GL.ACC,1,3) IN ('211', '213', '217', '241', '331') OR SUBSTR(GL.ACC,1,4) IN ('3411'))\n\t\tAND SUBSTR(GL.AGA,1,3) IN ('111', '112', '113')\n\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\n\t\t) P ON 1=1\n\n\tUNION ALL\n\n\tSELECT '22' RPT_KEY, \n\tC.AMT AMT,\n\tP.AMT P_AMT\n\tFROM (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111', '112', '113') \n\t\tAND (SUBSTR(GL.AGA,1,3) IN ('711','131') OR SUBSTR(GL.AGA,1,4) IN ('5117'))\n\t\tAND GL.DT BETWEEN T.START AND T.END\n\t\t) C \n\tLEFT JOIN (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111', '112', '113') \n\t\tAND (SUBSTR(GL.AGA,1,3) IN ('711','131') OR SUBSTR(GL.AGA,1,4) IN ('5117'))\n\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\n\t\t) P ON 1=1\n\n\tUNION ALL\n\n\tSELECT '23' RPT_KEY, \n\tC.AMT AMT,\n\tP.AMT P_AMT\n\tFROM (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('128', '171')\n\t\tAND SUBSTR(GL.AGA,1,3) IN ('111', '112', '113')\n\t\tAND GL.DT BETWEEN T.START AND T.END\n\t\t) C \n\tLEFT JOIN (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('128', '171')\n\t\tAND SUBSTR(GL.AGA,1,3) IN ('111', '112', '113')\n\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\n\t\t) P ON 1=1\n\n\tUNION ALL\n\n\tSELECT '24' RPT_KEY, \n\tC.AMT AMT,\n\tP.AMT P_AMT\n\tFROM (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111', '112', '113')\n\t\tAND SUBSTR(GL.AGA,1,3) IN ('128', '171')\n\t\tAND GL.DT BETWEEN T.START AND T.END\n\t\t) C \n\tLEFT JOIN (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111', '112', '113')\n\t\tAND SUBSTR(GL.AGA,1,3) IN ('128', '171')\n\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\n\t\t) P ON 1=1\n\n\tUNION ALL\n\n\tSELECT '25' RPT_KEY, \n\tC.AMT AMT,\n\tP.AMT P_AMT\n\tFROM (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE (SUBSTR(GL.ACC,1,3) IN ('221', '222','331') OR SUBSTR(GL.ACC,1,4) IN ('2281'))\n\t\tAND SUBSTR(GL.AGA,1,3) IN ('111', '112', '113')\n\t\tAND GL.DT BETWEEN T.START AND T.END\n\t\t) C \n\tLEFT JOIN (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE (SUBSTR(GL.ACC,1,3) IN ('221', '222', '331') OR SUBSTR(GL.ACC,1,4) IN ('2281'))\n\t\tAND SUBSTR(GL.AGA,1,3) IN ('111', '112', '113')\n\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\n\t\t) P ON 1=1\n\n\tUNION ALL\n\n\tSELECT '26' RPT_KEY, \n\tC.AMT AMT,\n\tP.AMT P_AMT\n\tFROM (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111','121','113') \n\t\tAND (SUBSTR(GL.AGA,1,3) IN ('221', '222', '131') OR SUBSTR(GL.AGA,1,4) IN ( '2281'))\n\t\tAND GL.DT BETWEEN T.START AND T.END\n\t\t) C \n\tLEFT JOIN (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111','121','113') \n\t\tAND (SUBSTR(GL.AGA,1,3) IN ('221', '222', '131') OR SUBSTR(GL.AGA,1,4) IN ( '2281'))\n\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\n\t\t) P ON 1=1\n\n\tUNION ALL\n\n\tSELECT '27' RPT_KEY, \n\tC.AMT AMT,\n\tP.AMT P_AMT\n\tFROM (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,3) IN (\t'111', '112', '113')\n\t\tAND SUBSTR(GL.AGA,1,3) IN ('515')\n\t\tAND GL.DT BETWEEN T.START AND T.END\n\t\t) C \n\tLEFT JOIN (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,3) IN (\t'111', '112', '113')\n\t\tAND SUBSTR(GL.AGA,1,3) IN ('515')\n\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\n\t\t) P ON 1=1\n\n\tUNION ALL\n\n\tSELECT '31' RPT_KEY, \n\tC.AMT AMT,\n\tP.AMT P_AMT\n\tFROM (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111', '112', '113')\n\t\tAND SUBSTR(GL.AGA,1,3) IN ('411', '419')\n\t\tAND GL.DT BETWEEN T.START AND T.END\n\t\t) C \n\tLEFT JOIN (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111', '112', '113')\n\t\tAND SUBSTR(GL.AGA,1,3) IN ('411', '419')\n\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\n\t\t) P ON 1=1\n\n\tUNION ALL\n\n\tSELECT '32' RPT_KEY, \n\tC.AMT AMT,\n\tP.AMT P_AMT\n\tFROM (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('411','419') \n\t\tAND SUBSTR(GL.AGA,1,3) IN ('111','112','113')\n\t\tAND GL.DT BETWEEN T.START AND T.END\n\t\t) C \n\tLEFT JOIN (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('411','419') \n\t\tAND SUBSTR(GL.AGA,1,3) IN ('111','112','113')\n\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\n\t\t) P ON 1=1\n\n\tUNION ALL\n\n\tSELECT '33' RPT_KEY, \n\tC.AMT AMT,\n\tP.AMT P_AMT\n\tFROM (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111', '112', '113')\n\t\tAND SUBSTR(GL.AGA,1,4) IN ('3411','3431','3432','4112')\n\t\tAND GL.DT BETWEEN T.START AND T.END\n\t\t) C \n\tLEFT JOIN (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111', '112', '113')\n\t\tAND SUBSTR(GL.AGA,1,4) IN ('3411','3431','3432','4112')\n\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\n\t\t) P ON 1=1\n\n\tUNION ALL\n\n\tSELECT '34' RPT_KEY, \n\tC.AMT AMT,\n\tP.AMT P_AMT\n\tFROM (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,4) IN ('3411','3431','3432','4112')\n\t\tAND SUBSTR(GL.AGA,1,3) IN ('111', '112', '113')\n\t\tAND GL.DT BETWEEN T.START AND T.END\n\t\t) C \n\tLEFT JOIN (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,4) IN ('3411','3431','3432','4112')\n\t\tAND SUBSTR(GL.AGA,1,3) IN ('111', '112', '113')\n\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\n\t\t) P ON 1=1\n\n\tUNION ALL\n\n\tSELECT '35' RPT_KEY, \n\tC.AMT AMT,\n\tP.AMT P_AMT\n\tFROM (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,4) IN ('3412')\n\t\tAND SUBSTR(GL.AGA,1,3) IN ('111', '112', '113')\n\t\tAND GL.DT BETWEEN T.START AND T.END\n\t\t) C \n\tLEFT JOIN (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,4) IN ('3412')\n\t\tAND SUBSTR(GL.AGA,1,3) IN ('111', '112', '113')\n\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\n\t\t) P ON 1=1\n\n\tUNION ALL\n\n\tSELECT '36' RPT_KEY, \n\tC.AMT AMT,\n\tP.AMT P_AMT\n\tFROM (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('421','338')\n\t\tAND SUBSTR(GL.AGA,1,3) IN ('111', '112', '113')\n\t\tAND GL.DT BETWEEN T.START AND T.END\n\t\t) C \n\tLEFT JOIN (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('421','338')\n\t\tAND SUBSTR(GL.AGA,1,3) IN ('111', '112', '113')\n\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\n\t\t) P ON 1=1\n\n\tUNION ALL\n\n\tSELECT '60' RPT_KEY, \n\tC.AMT AMT,\n\tP.AMT P_AMT\n\tFROM (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111', '112', '113')\n\t\tAND SUBSTR(GL.AGA,1,4) IN ('1281','1288')\n\t\tAND GL.DT BETWEEN T.START AND T.END\n\t\t) C \n\tLEFT JOIN (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111', '112', '113', '128')\n\t\tAND SUBSTR(GL.AGA,1,4) IN ('4131')\n\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\n\t\t) P ON 1=1\n\n\tUNION ALL\n\n\tSELECT '61' RPT_KEY, \n\tC.AMT AMT,\n\tP.AMT P_AMT\n\tFROM (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111', '112', '113', '128')\n\t\tAND SUBSTR(GL.AGA,1,4) IN ('4131')\n\t\tAND GL.DT BETWEEN T.START AND T.END\n\t\t) C \n\tLEFT JOIN (\n\t\tSELECT \n\t\tSUM(GL.NO - GL.CO) AMT\n\t\tFROM GLT GL CROSS JOIN TIMET T\n\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111', '112', '113', '128')\n\t\tAND SUBSTR(GL.AGA,1,4) IN ('4131')\n\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\n\t\t) P ON 1=1\n),\nTMP1 AS (\nSELECT '20' RPT_KEY, \nC.AMT AMT,\nP.AMT P_AMT\nFROM (\n\tSELECT \n\tSUM(T.AMT) AMT\n\tFROM TMP0 T\n\tWHERE RPT_KEY IN ('01','02','03','04','05','06','07')\n\t) C \nLEFT JOIN (\n\tSELECT \n\tSUM(T.P_AMT) AMT\n\tFROM TMP0 T\n\tWHERE RPT_KEY IN ('01','02','03','04','05','06','07')\n\t) P ON 1=1\n\t\nUNION ALL\n\nSELECT '30' RPT_KEY, \nC.AMT AMT,\nP.AMT P_AMT\nFROM (\n\tSELECT \n\tSUM(T.AMT) AMT\n\tFROM TMP0 T\n\tWHERE RPT_KEY IN ('21','22','23','24','25','26','27')\n\t) C \nLEFT JOIN (\n\tSELECT \n\tSUM(T.P_AMT) AMT\n\tFROM TMP0 T\n\tWHERE RPT_KEY IN ('21','22','23','24','25','26','27')\n\t) P ON 1=1\n\t\nUNION ALL\n\nSELECT '40' RPT_KEY, \nC.AMT AMT,\nP.AMT P_AMT\nFROM (\n\tSELECT \n\tSUM(T.AMT) AMT\n\tFROM TMP0 T\n\tWHERE RPT_KEY IN ('31','32','33','34','35','36')\n\t) C \nLEFT JOIN (\n\tSELECT \n\tSUM(T.P_AMT) AMT\n\tFROM TMP0 T\n\tWHERE RPT_KEY IN ('31','32','33','34','35','36')\n\t) P ON 1=1\n)\n, TMP2 AS (\n\tSELECT '50' RPT_KEY, \n\tC.AMT AMT,\n\tP.AMT P_AMT\n\tFROM (\n\t\tSELECT \n\t\tSUM(T.AMT) AMT\n\t\tFROM TMP1 T\n\t\tWHERE RPT_KEY IN ('20','30','40')\n\t\t) C \n\tLEFT JOIN (\n\t\tSELECT \n\t\tSUM(T.P_AMT) AMT\n\t\tFROM TMP1 T\n\t\tWHERE RPT_KEY IN ('20','30','40')\n\t\t) P ON 1=1 \n)\nSELECT A1.RPT_NAME 'Chi ti\u00eau',\n\tA1.RPT_KEY 'M\u00e3 s\u1ed1', \n\tA2.AMT AMT,\n\tA2.P_AMT P_AMT\n\tFROM NAME_TMP A1\nLEFT JOIN (\n\tSELECT * FROM TMP0\n\tUNION ALL\n\tSELECT * FROM TMP1\n\tUNION ALL\n\tSELECT * FROM TMP2\n) A2 ON A2.RPT_KEY = A1.RPT_KEY",
 "ref_doctype": "GL Entry",
 "report_name": "GL08 - S\u1ed5 qu\u1ef9 chi ti\u1ebft ti\u1ec1n m\u1eb7t",
 "report_type": "Script Report",
 "roles": [
  {
   "role": "Accounts Manager"
  },
  {
   "role": "Auditor"
  },
  {
   "role": "Accounts User"
  }
 ]
}