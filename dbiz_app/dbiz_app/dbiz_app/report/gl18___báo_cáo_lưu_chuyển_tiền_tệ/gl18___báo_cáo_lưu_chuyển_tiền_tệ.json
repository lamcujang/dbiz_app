{
 "add_total_row": 0,
 "columns": [],
 "creation": "2024-11-21 15:09:02.665711",
 "disabled": 0,
 "docstatus": 0,
 "doctype": "Report",
 "filters": [
  {
   "fieldname": "end_date",
   "fieldtype": "Date",
   "label": "Ng\u00e0y k\u1ebft th\u00fac",
   "mandatory": 1,
   "wildcard_filter": 0
  },
  {
   "fieldname": "company",
   "fieldtype": "Date",
   "label": "C\u00f4ng ty",
   "mandatory": 1,
   "wildcard_filter": 0
  }
 ],
 "idx": 0,
 "is_standard": "Yes",
 "letterhead": null,
 "modified": "2025-05-09 09:56:38.897658",
 "modified_by": "Administrator",
 "module": "DBIZ APP",
 "name": "GL18 - B\u00e1o c\u00e1o l\u01b0u chuy\u1ec3n ti\u1ec1n t\u1ec7",
 "owner": "Administrator",
 "prepared_report": 0,
 "query": "WITH NAME_TMP AS (\r\n\t\t\t\tSELECT 'I. L\u01b0u chuy\u1ec3n ti\u1ec1n t\u1ec7 t\u1eeb ho\u1ea1t \u0111\u1ed9ng kinh doanh' RPT_NAME, NULL RPT_KEY \r\n\t\t\t\tUNION ALL\r\n\t\t\t\tSELECT'1. Ti\u1ec1n t\u1eeb b\u00e1n h\u00e0ng, cung c\u1ea5p d\u1ecbch v\u1ee5 v\u00e0 doanh thu kh\u00e1c' RPT_NAME, '01' RPT_KEY \r\n\t\t\t\tUNION ALL\r\n\t\t\t\tSELECT '2. Ti\u1ec1n chi tr\u1ea3 cho ng\u01b0\u1eddi cung c\u1ea5p h\u00e0ng h\u00f3a v\u00e0 d\u1ecbch v\u1ee5' RPT_NAME, '02' RPT_KEY \r\n\t\t\t\tUNION ALL\r\n\t\t\t\tSELECT '3. Ti\u1ec1n chi tr\u1ea3 cho ng\u01b0\u1eddi lao \u0111\u1ed9ng' RPT_NAME, '03' RPT_KEY \r\n\t\t\t\tUNION ALL\r\n\t\t\t\tSELECT '4. Ti\u1ec1n l\u00e3i vay \u0111\u00e3 tr\u1ea3' RPT_NAME, '04' RPT_KEY \r\n\t\t\t\tUNION ALL\r\n\t\t\t\tSELECT '5. Thu\u1ebf thu nh\u1eadp doanh nghi\u1ec7p \u0111\u00e3 n\u1ed9p' RPT_NAME, '05' RPT_KEY \r\n\t\t\t\tUNION ALL\r\n\t\t\t\tSELECT '6. Ti\u1ec1n thu kh\u00e1c t\u1eeb H\u0110KD' RPT_NAME, '06' RPT_KEY \r\n\t\t\t\tUNION ALL\r\n\t\t\t\tSELECT '7. Ti\u1ec1n chi kh\u00e1c cho H\u0110KD' RPT_NAME, '07' RPT_KEY \r\n\t\t\t\tUNION ALL\r\n\t\t\t\tSELECT 'LCTT Thu\u1ea7n t\u1eeb H\u0110KD' RPT_NAME, '20' RPT_KEY \r\n\t\t\t\tUNION ALL\r\n\t\t\t\tSELECT 'II. L\u01b0u chuy\u1ec3n ti\u1ec1n t\u1ec7 t\u1eeb ho\u1ea1t \u0111\u1ed9ng \u0111\u1ea7u t\u01b0' RPT_NAME, NULL RPT_KEY \r\n\t\t\t\tUNION ALL\r\n\t\t\t\tSELECT '1. Ti\u1ec1n chi mua s\u1eafm, x\u00e2y d\u1ef1ng TSC\u0110 v\u00e0 t\u00e0i s\u1ea3n kh\u00e1c' RPT_NAME, '21' RPT_KEY \r\n\t\t\t\tUNION ALL\r\n\t\t\t\tSELECT '2. Ti\u1ec1n thu t\u1eeb thanh l\u00fd, nh\u01b0\u1ee3ng b\u00e1n TSC\u0110 v\u00e0 t\u00e0i s\u1ea3n kh\u00e1c' RPT_NAME, '22' RPT_KEY \r\n\t\t\t\tUNION ALL\r\n\t\t\t\tSELECT '3. Ti\u1ec1n chi cho vay, mua c\u00f4ng c\u1ee5 n\u1ee3 c\u1ee7a \u0111\u01a1n v\u1ecb kh\u00e1c' RPT_NAME, '23' RPT_KEY \r\n\t\t\t\tUNION ALL\r\n\t\t\t\tSELECT '4. Ti\u1ec1n thu h\u1ed3i cho vay, b\u00e1n l\u1ea1i c\u00e1c c\u00f4ng c\u1ee5 n\u1ee3 c\u1ee7a \u0111\u01a1n v\u1ecb kh\u00e1c' RPT_NAME, '24' RPT_KEY \r\n\t\t\t\tUNION ALL\r\n\t\t\t\tSELECT '5. Ti\u1ec1n chi \u0111\u1ea7u t\u01b0 g\u00f3p v\u1ed1n v\u00e0o \u0111\u01a1n v\u1ecb kh\u00e1c' RPT_NAME, '25' RPT_KEY \r\n\t\t\t\tUNION ALL\r\n\t\t\t\tSELECT '6. Ti\u1ec1n thu h\u1ed3i \u0111\u1ea7u t\u01b0 g\u00f3p v\u1ed1n v\u00e0o \u0111\u01a1n v\u1ecb kh\u00e1c' RPT_NAME, '26' RPT_KEY \r\n\t\t\t\tUNION ALL\r\n\t\t\t\tSELECT '7. Ti\u1ec1n thu l\u00e3i cho vay, c\u1ed5 t\u1ee9c v\u00e0 l\u1ee3i nhu\u1eadn \u0111\u01b0\u1ee3c chia' RPT_NAME, '27' RPT_KEY \r\n\t\t\t\tUNION ALL\r\n\t\t\t\tSELECT 'LCTT thu\u1ea7n t\u1eeb Ho\u1ea1t \u0111\u1ed9ng \u0111\u1ea7u t\u01b0' RPT_NAME, '30' RPT_KEY \r\n\t\t\t\tUNION ALL\r\n\t\t\t\tSELECT 'III. L\u01b0u chuy\u1ec3n ti\u1ec1n t\u1ec7 t\u1eeb ho\u1ea1t \u0111\u1ed9ng t\u00e0i ch\u00ednh' RPT_NAME, NULL RPT_KEY \r\n\t\t\t\tUNION ALL\r\n\t\t\t\tSELECT '1.Ti\u1ec1n thu t\u1eeb ph\u00e1t h\u00e0nh c\u1ed5 phi\u1ebfu, nh\u1eadn v\u1ed1n g\u00f3p c\u1ee7a ch\u1ee7 s\u1edf h\u1eefu' RPT_NAME, '31' RPT_KEY \r\n\t\t\t\tUNION ALL\r\n\t\t\t\tSELECT '2.Ti\u1ec1n chi tr\u1ea3 v\u1ed1n g\u00f3p cho c\u00e1c ch\u1ee7 s\u1edf h\u1eefu, mua l\u1ea1i c\u1ed5 phi\u1ebfu c\u1ee7a doanh nghi\u1ec7p \u0111\u00e3 ph\u00e1t h\u00e0nh' RPT_NAME, '32' RPT_KEY \r\n\t\t\t\tUNION ALL\r\n\t\t\t\tSELECT '3. Ti\u1ec1n vay ng\u1eafn h\u1ea1n, d\u00e0i h\u1ea1n nh\u1eadn \u0111\u01b0\u1ee3c' RPT_NAME, '33' RPT_KEY \r\n\t\t\t\tUNION ALL\r\n\t\t\t\tSELECT '4. Ti\u1ec1n chi tr\u1ea3 n\u1ee3 g\u1ed1c vay' RPT_NAME, '34' RPT_KEY \r\n\t\t\t\tUNION ALL\r\n\t\t\t\tSELECT '5. C\u1ed5 t\u1ee9c, l\u1ee3i nhu\u1eadn \u0111\u00e3 tr\u1ea3 cho ch\u1ee7 s\u1edf h\u1eefu' RPT_NAME, '35' RPT_KEY \r\n\t\t\t\tUNION ALL\r\n\t\t\t\tSELECT '6. Ti\u1ec1n chi tr\u1ea3 n\u1ee3 thu\u00ea t\u00e0i ch\u00ednh' RPT_NAME, '36' RPT_KEY \r\n\t\t\t\tUNION ALL\r\n\t\t\t\tSELECT 'LCTT thu\u1ea7n t\u1eeb Ho\u1ea1t \u0111\u1ed9ng t\u00e0i ch\u00ednh' RPT_NAME, '40' RPT_KEY \r\n\t\t\t\tUNION ALL\r\n\t\t\t\tSELECT 'L\u01b0u chuy\u1ec3n ti\u1ec1n t\u1ec7 thu\u1ea7n trong k\u1ef3 (50 = 20 + 30 + 40)' RPT_NAME, '50' RPT_KEY \r\n\t\t\t\tUNION ALL\r\n\t\t\t\tSELECT 'Ti\u1ec1n v\u00e0 t\u01b0\u01a1ng \u0111\u01b0\u01a1ng ti\u1ec1n \u0111\u1ea7u k\u1ef3' RPT_NAME, '60' RPT_KEY \r\n\t\t\t\tUNION ALL\r\n\t\t\t\tSELECT '\u1ea2nh h\u01b0\u1edfng c\u1ee7a thay \u0111\u1ed5i t\u1ef7 gi\u00e1 h\u1ed1i \u0111o\u00e1i quy \u0111\u1ed5i ngo\u1ea1i t\u1ec7' RPT_NAME, '61' RPT_KEY \r\n\t\t\t\tUNION ALL\r\n\t\t\t\tSELECT 'Ti\u1ec1n v\u00e0 t\u01b0\u01a1ng \u0111\u01b0\u01a1ng ti\u1ec1n cu\u1ed1i k\u1ef3 (70 = 50 + 60 + 61)' RPT_NAME, '70' RPT_KEY \r\n\t\t\t\t)\r\n\t\t\t, TIMET AS (\r\n\t\t\t\tSELECT \r\n\t\t\t\tDATE(%(end_date)s) END,\r\n\t\t\t\tDATE(CONCAT(YEAR(DATE(%(end_date)s)), '-01-01')) START,\r\n\t\t\t\tDATE(CONCAT(YEAR(DATE(%(end_date)s)) - 1, '-12-31')) PEND,\r\n\t\t\t\tDATE(CONCAT(YEAR(DATE(%(end_date)s)) - 1, '-01-01')) PSTART\r\n\t\t\t)\r\n\t\t\t, GLT AS (\r\n\t\t\t\tSELECT \r\n\t\t\t\t\tGL.CREDIT CO, \r\n\t\t\t\t\tGL.DEBIT NO,\r\n\t\t\t\t\tGL.POSTING_DATE DT,\r\n\t\t\t\t\tGL.ACCOUNT ACC,\r\n\t\t\t\t\tGL.AGAINST AGA\r\n\t\t\t\tFROM `tabGL Entry` GL\r\n\t\t\t\tWHERE GL.COMPANY =%(company)s\r\n\t\t\t\tAND IS_CANCELLED = 0\r\n\t\t\t)\r\n\t\t\t, TMP0 AS(  \r\n\t\t\t\tSELECT '01' RPT_KEY, \r\n\t\t\t\tC.AMT AMT,\r\n\t\t\t\tP.AMT P_AMT\r\n\t\t\t\tFROM (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL \r\n\t\t\t\t\tCROSS JOIN TIMET T \r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111','121','113')\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('511','131','515','121')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.START AND T.END\r\n\t\t\t\t\t) C \r\n\t\t\t\tLEFT JOIN (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111','121','113')\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('511','131','515','121')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\r\n\t\t\t\t\t) P ON 1=1\r\n\r\n\t\t\t\tUNION ALL\r\n\r\n\t\t\t\tSELECT '02' RPT_KEY, \r\n\t\t\t\tC.AMT AMT,\r\n\t\t\t\tP.AMT P_AMT\r\n\t\t\t\tFROM (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('331','152','153','154','156') \r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('111','121','113')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.START AND T.END\r\n\t\t\t\t\t) C \r\n\t\t\t\tLEFT JOIN (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('331','152','153','154','156')\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('111','121','113')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\r\n\t\t\t\t\t) P ON 1=1\r\n\r\n\t\t\t\tUNION ALL\r\n\r\n\t\t\t\tSELECT '03' RPT_KEY, \r\n\t\t\t\tC.AMT AMT,\r\n\t\t\t\tP.AMT P_AMT\r\n\t\t\t\tFROM (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('334') \r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('111','121')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.START AND T.END\r\n\t\t\t\t\t) C \r\n\t\t\t\tLEFT JOIN (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('334') \r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('111','121')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\r\n\t\t\t\t\t) P ON 1=1\r\n\r\n\t\t\t\tUNION ALL\r\n\r\n\t\t\t\tSELECT '04' RPT_KEY, \r\n\t\t\t\tC.AMT AMT,\r\n\t\t\t\tP.AMT P_AMT\r\n\t\t\t\tFROM (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE (SUBSTR(GL.ACC,1,3) IN ('335', '242') OR SUBSTR(GL.ACC,1,4) IN ('6354'))\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('111','121')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.START AND T.END\r\n\t\t\t\t\t) C \r\n\t\t\t\tLEFT JOIN (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE (SUBSTR(GL.ACC,1,3) IN ('335', '242') OR SUBSTR(GL.ACC,1,4) IN ('6354'))\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('111','121')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\r\n\t\t\t\t\t) P ON 1=1\r\n\r\n\t\t\t\tUNION ALL\r\n\r\n\t\t\t\tSELECT '05' RPT_KEY, \r\n\t\t\t\tC.AMT AMT,\r\n\t\t\t\tP.AMT P_AMT\r\n\t\t\t\tFROM (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,4) IN ('3334')\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('111','121')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.START AND T.END\r\n\t\t\t\t\t) C \r\n\t\t\t\tLEFT JOIN (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,4) IN ('3334')\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('111','121')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\r\n\t\t\t\t\t) P ON 1=1\r\n\r\n\t\t\t\tUNION ALL\r\n\r\n\t\t\t\tSELECT '06' RPT_KEY, \r\n\t\t\t\tC.AMT AMT,\r\n\t\t\t\tP.AMT P_AMT\r\n\t\t\t\tFROM (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111','121','113') \r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('711', '133', '141', '244')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.START AND T.END\r\n\t\t\t\t\t) C \r\n\t\t\t\tLEFT JOIN (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111','121','113') \r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('711', '133', '141', '244')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\r\n\t\t\t\t\t) P ON 1=1\r\n\r\n\t\t\t\tUNION ALL\r\n\r\n\t\t\t\tSELECT '07' RPT_KEY, \r\n\t\t\t\tC.AMT AMT,\r\n\t\t\t\tP.AMT P_AMT\r\n\t\t\t\tFROM (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('811', '161', '244', '333', '338',  '344', '352', '353', '356')\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('111','121','113')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.START AND T.END\r\n\t\t\t\t\t) C \r\n\t\t\t\tLEFT JOIN (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('811', '161', '244', '333', '338',  '344', '352', '353', '356')\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('111','121','113')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\r\n\t\t\t\t\t) P ON 1=1\r\n\r\n\t\t\t\tUNION ALL\r\n\r\n\t\t\t\tSELECT '21' RPT_KEY, \r\n\t\t\t\tC.AMT AMT,\r\n\t\t\t\tP.AMT P_AMT\r\n\t\t\t\tFROM (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE (SUBSTR(GL.ACC,1,3) IN ('211', '213', '217', '241', '331') OR SUBSTR(GL.ACC,1,4) IN ('3411'))\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('111', '112', '113')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.START AND T.END\r\n\t\t\t\t\t) C \r\n\t\t\t\tLEFT JOIN (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE (SUBSTR(GL.ACC,1,3) IN ('211', '213', '217', '241', '331') OR SUBSTR(GL.ACC,1,4) IN ('3411'))\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('111', '112', '113')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\r\n\t\t\t\t\t) P ON 1=1\r\n\r\n\t\t\t\tUNION ALL\r\n\r\n\t\t\t\tSELECT '22' RPT_KEY, \r\n\t\t\t\tC.AMT AMT,\r\n\t\t\t\tP.AMT P_AMT\r\n\t\t\t\tFROM (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111', '112', '113') \r\n\t\t\t\t\tAND (SUBSTR(GL.AGA,1,3) IN ('711','131') OR SUBSTR(GL.AGA,1,4) IN ('5117'))\r\n\t\t\t\t\tAND GL.DT BETWEEN T.START AND T.END\r\n\t\t\t\t\t) C \r\n\t\t\t\tLEFT JOIN (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111', '112', '113') \r\n\t\t\t\t\tAND (SUBSTR(GL.AGA,1,3) IN ('711','131') OR SUBSTR(GL.AGA,1,4) IN ('5117'))\r\n\t\t\t\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\r\n\t\t\t\t\t) P ON 1=1\r\n\r\n\t\t\t\tUNION ALL\r\n\r\n\t\t\t\tSELECT '23' RPT_KEY, \r\n\t\t\t\tC.AMT AMT,\r\n\t\t\t\tP.AMT P_AMT\r\n\t\t\t\tFROM (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('128', '171')\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('111', '112', '113')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.START AND T.END\r\n\t\t\t\t\t) C \r\n\t\t\t\tLEFT JOIN (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('128', '171')\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('111', '112', '113')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\r\n\t\t\t\t\t) P ON 1=1\r\n\r\n\t\t\t\tUNION ALL\r\n\r\n\t\t\t\tSELECT '24' RPT_KEY, \r\n\t\t\t\tC.AMT AMT,\r\n\t\t\t\tP.AMT P_AMT\r\n\t\t\t\tFROM (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111', '112', '113')\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('128', '171')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.START AND T.END\r\n\t\t\t\t\t) C \r\n\t\t\t\tLEFT JOIN (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111', '112', '113')\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('128', '171')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\r\n\t\t\t\t\t) P ON 1=1\r\n\r\n\t\t\t\tUNION ALL\r\n\r\n\t\t\t\tSELECT '25' RPT_KEY, \r\n\t\t\t\tC.AMT AMT,\r\n\t\t\t\tP.AMT P_AMT\r\n\t\t\t\tFROM (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE (SUBSTR(GL.ACC,1,3) IN ('221', '222','331') OR SUBSTR(GL.ACC,1,4) IN ('2281'))\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('111', '112', '113')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.START AND T.END\r\n\t\t\t\t\t) C \r\n\t\t\t\tLEFT JOIN (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE (SUBSTR(GL.ACC,1,3) IN ('221', '222', '331') OR SUBSTR(GL.ACC,1,4) IN ('2281'))\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('111', '112', '113')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\r\n\t\t\t\t\t) P ON 1=1\r\n\r\n\t\t\t\tUNION ALL\r\n\r\n\t\t\t\tSELECT '26' RPT_KEY, \r\n\t\t\t\tC.AMT AMT,\r\n\t\t\t\tP.AMT P_AMT\r\n\t\t\t\tFROM (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111','121','113') \r\n\t\t\t\t\tAND (SUBSTR(GL.AGA,1,3) IN ('221', '222', '131') OR SUBSTR(GL.AGA,1,4) IN ( '2281'))\r\n\t\t\t\t\tAND GL.DT BETWEEN T.START AND T.END\r\n\t\t\t\t\t) C \r\n\t\t\t\tLEFT JOIN (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111','121','113') \r\n\t\t\t\t\tAND (SUBSTR(GL.AGA,1,3) IN ('221', '222', '131') OR SUBSTR(GL.AGA,1,4) IN ( '2281'))\r\n\t\t\t\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\r\n\t\t\t\t\t) P ON 1=1\r\n\r\n\t\t\t\tUNION ALL\r\n\r\n\t\t\t\tSELECT '27' RPT_KEY, \r\n\t\t\t\tC.AMT AMT,\r\n\t\t\t\tP.AMT P_AMT\r\n\t\t\t\tFROM (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,3) IN (\t'111', '112', '113')\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('515')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.START AND T.END\r\n\t\t\t\t\t) C \r\n\t\t\t\tLEFT JOIN (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,3) IN (\t'111', '112', '113')\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('515')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\r\n\t\t\t\t\t) P ON 1=1\r\n\r\n\t\t\t\tUNION ALL\r\n\r\n\t\t\t\tSELECT '31' RPT_KEY, \r\n\t\t\t\tC.AMT AMT,\r\n\t\t\t\tP.AMT P_AMT\r\n\t\t\t\tFROM (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111', '112', '113')\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('411', '419')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.START AND T.END\r\n\t\t\t\t\t) C \r\n\t\t\t\tLEFT JOIN (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111', '112', '113')\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('411', '419')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\r\n\t\t\t\t\t) P ON 1=1\r\n\r\n\t\t\t\tUNION ALL\r\n\r\n\t\t\t\tSELECT '32' RPT_KEY, \r\n\t\t\t\tC.AMT AMT,\r\n\t\t\t\tP.AMT P_AMT\r\n\t\t\t\tFROM (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('411','419') \r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('111','112','113')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.START AND T.END\r\n\t\t\t\t\t) C \r\n\t\t\t\tLEFT JOIN (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('411','419') \r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('111','112','113')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\r\n\t\t\t\t\t) P ON 1=1\r\n\r\n\t\t\t\tUNION ALL\r\n\r\n\t\t\t\tSELECT '33' RPT_KEY, \r\n\t\t\t\tC.AMT AMT,\r\n\t\t\t\tP.AMT P_AMT\r\n\t\t\t\tFROM (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111', '112', '113')\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,4) IN ('3411','3431','3432','4112')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.START AND T.END\r\n\t\t\t\t\t) C \r\n\t\t\t\tLEFT JOIN (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111', '112', '113')\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,4) IN ('3411','3431','3432','4112')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\r\n\t\t\t\t\t) P ON 1=1\r\n\r\n\t\t\t\tUNION ALL\r\n\r\n\t\t\t\tSELECT '34' RPT_KEY, \r\n\t\t\t\tC.AMT AMT,\r\n\t\t\t\tP.AMT P_AMT\r\n\t\t\t\tFROM (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,4) IN ('3411','3431','3432','4112')\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('111', '112', '113')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.START AND T.END\r\n\t\t\t\t\t) C \r\n\t\t\t\tLEFT JOIN (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,4) IN ('3411','3431','3432','4112')\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('111', '112', '113')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\r\n\t\t\t\t\t) P ON 1=1\r\n\r\n\t\t\t\tUNION ALL\r\n\r\n\t\t\t\tSELECT '35' RPT_KEY, \r\n\t\t\t\tC.AMT AMT,\r\n\t\t\t\tP.AMT P_AMT\r\n\t\t\t\tFROM (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,4) IN ('3412')\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('111', '112', '113')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.START AND T.END\r\n\t\t\t\t\t) C \r\n\t\t\t\tLEFT JOIN (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,4) IN ('3412')\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('111', '112', '113')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\r\n\t\t\t\t\t) P ON 1=1\r\n\r\n\t\t\t\tUNION ALL\r\n\r\n\t\t\t\tSELECT '36' RPT_KEY, \r\n\t\t\t\tC.AMT AMT,\r\n\t\t\t\tP.AMT P_AMT\r\n\t\t\t\tFROM (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('421','338')\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('111', '112', '113')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.START AND T.END\r\n\t\t\t\t\t) C \r\n\t\t\t\tLEFT JOIN (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('421','338')\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,3) IN ('111', '112', '113')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\r\n\t\t\t\t\t) P ON 1=1\r\n\r\n\t\t\t\tUNION ALL\r\n\r\n\t\t\t\tSELECT '60' RPT_KEY, \r\n\t\t\t\tC.AMT AMT,\r\n\t\t\t\tP.AMT P_AMT\r\n\t\t\t\tFROM (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111', '112', '113')\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,4) IN ('1281','1288')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.START AND T.END\r\n\t\t\t\t\t) C \r\n\t\t\t\tLEFT JOIN (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111', '112', '113', '128')\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,4) IN ('4131')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\r\n\t\t\t\t\t) P ON 1=1\r\n\r\n\t\t\t\tUNION ALL\r\n\r\n\t\t\t\tSELECT '61' RPT_KEY, \r\n\t\t\t\tC.AMT AMT,\r\n\t\t\t\tP.AMT P_AMT\r\n\t\t\t\tFROM (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111', '112', '113', '128')\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,4) IN ('4131')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.START AND T.END\r\n\t\t\t\t\t) C \r\n\t\t\t\tLEFT JOIN (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(GL.NO - GL.CO) AMT\r\n\t\t\t\t\tFROM GLT GL CROSS JOIN TIMET T\r\n\t\t\t\t\tWHERE SUBSTR(GL.ACC,1,3) IN ('111', '112', '113', '128')\r\n\t\t\t\t\tAND SUBSTR(GL.AGA,1,4) IN ('4131')\r\n\t\t\t\t\tAND GL.DT BETWEEN T.PSTART AND T.PEND\r\n\t\t\t\t\t) P ON 1=1\r\n\t\t\t),\r\n\t\t\tTMP1 AS (\r\n\t\t\tSELECT '20' RPT_KEY, \r\n\t\t\tC.AMT AMT,\r\n\t\t\tP.AMT P_AMT\r\n\t\t\tFROM (\r\n\t\t\t\tSELECT \r\n\t\t\t\tSUM(T.AMT) AMT\r\n\t\t\t\tFROM TMP0 T\r\n\t\t\t\tWHERE RPT_KEY IN ('01','02','03','04','05','06','07')\r\n\t\t\t\t) C \r\n\t\t\tLEFT JOIN (\r\n\t\t\t\tSELECT \r\n\t\t\t\tSUM(T.P_AMT) AMT\r\n\t\t\t\tFROM TMP0 T\r\n\t\t\t\tWHERE RPT_KEY IN ('01','02','03','04','05','06','07')\r\n\t\t\t\t) P ON 1=1\r\n\t\t\t\t\r\n\t\t\tUNION ALL\r\n\r\n\t\t\tSELECT '30' RPT_KEY, \r\n\t\t\tC.AMT AMT,\r\n\t\t\tP.AMT P_AMT\r\n\t\t\tFROM (\r\n\t\t\t\tSELECT \r\n\t\t\t\tSUM(T.AMT) AMT\r\n\t\t\t\tFROM TMP0 T\r\n\t\t\t\tWHERE RPT_KEY IN ('21','22','23','24','25','26','27')\r\n\t\t\t\t) C \r\n\t\t\tLEFT JOIN (\r\n\t\t\t\tSELECT \r\n\t\t\t\tSUM(T.P_AMT) AMT\r\n\t\t\t\tFROM TMP0 T\r\n\t\t\t\tWHERE RPT_KEY IN ('21','22','23','24','25','26','27')\r\n\t\t\t\t) P ON 1=1\r\n\t\t\t\t\r\n\t\t\tUNION ALL\r\n\r\n\t\t\tSELECT '40' RPT_KEY, \r\n\t\t\tC.AMT AMT,\r\n\t\t\tP.AMT P_AMT\r\n\t\t\tFROM (\r\n\t\t\t\tSELECT \r\n\t\t\t\tSUM(T.AMT) AMT\r\n\t\t\t\tFROM TMP0 T\r\n\t\t\t\tWHERE RPT_KEY IN ('31','32','33','34','35','36')\r\n\t\t\t\t) C \r\n\t\t\tLEFT JOIN (\r\n\t\t\t\tSELECT \r\n\t\t\t\tSUM(T.P_AMT) AMT\r\n\t\t\t\tFROM TMP0 T\r\n\t\t\t\tWHERE RPT_KEY IN ('31','32','33','34','35','36')\r\n\t\t\t\t) P ON 1=1\r\n\t\t\t)\r\n\t\t\t, TMP2 AS (\r\n\t\t\t\tSELECT '50' RPT_KEY, \r\n\t\t\t\tC.AMT AMT,\r\n\t\t\t\tP.AMT P_AMT\r\n\t\t\t\tFROM (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(T.AMT) AMT\r\n\t\t\t\t\tFROM TMP1 T\r\n\t\t\t\t\tWHERE RPT_KEY IN ('20','30','40')\r\n\t\t\t\t\t) C \r\n\t\t\t\tLEFT JOIN (\r\n\t\t\t\t\tSELECT \r\n\t\t\t\t\tSUM(T.P_AMT) AMT\r\n\t\t\t\t\tFROM TMP1 T\r\n\t\t\t\t\tWHERE RPT_KEY IN ('20','30','40')\r\n\t\t\t\t\t) P ON 1=1 \r\n\t\t\t)\r\n\t\t\tSELECT A1.RPT_NAME,\r\n\t\t\tA1.RPT_KEY, \r\n\t\t\tA2.AMT AMT,\r\n\t\t\tA2.P_AMT P_AMT\r\n\t\t\tFROM NAME_TMP A1\r\n\t\t\tLEFT JOIN (\r\n\t\t\t\tSELECT * FROM TMP0\r\n\t\t\t\tUNION ALL\r\n\t\t\t\tSELECT * FROM TMP1\r\n\t\t\t\tUNION ALL\r\n\t\t\t\tSELECT * FROM TMP2\r\n\t\t\t) A2 ON A2.RPT_KEY = A1.RPT_KEY",
 "ref_doctype": "GL Entry",
 "reference_report": "",
 "report_name": "GL18 - B\u00e1o c\u00e1o l\u01b0u chuy\u1ec3n ti\u1ec1n t\u1ec7",
 "report_type": "Script Report",
 "roles": [
  {
   "role": "Gi\u00e1m \u0111\u1ed1c T\u00e0i ch\u00ednh"
  },
  {
   "role": "Auditor"
  },
  {
   "role": "K\u1ebf to\u00e1n"
  }
 ]
}